<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å®¶æ¢ã—ãƒãƒƒãƒ—</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css">
  <style>
    html, body, #map {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    .leaflet-container {
      font-size: 1rem;
    }
    .smile-hover:hover {
      animation: smile-spin 0.6s linear;
    }
    @keyframes smile-spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .station-label {
      background-color: transparent;
      color: green;
      font-size: 13px;
      text-align: center;
      white-space: nowrap;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="text-center fw-bold" style="margin: 8px 0; font-size: 20px">
    ğŸ˜€å®¶æ¢ã—ã ãœã„ğŸ˜€ï¼ˆã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨è©³ã—ã„æƒ…å ±ã ã‚ˆï¼‰
  </div>
  <div id="map"></div>

  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>

  <script>
    const map = L.map('map').setView([35.68, 139.75], 11);

    L.tileLayer('http://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {
      attribution: 'Google',
      maxZoom: 18
    }).addTo(map);

    function createPopupContent(stationName, travelTime, nature, quietness, rent, farm) {
      const id = `memo_${stationName}`;
      return `
        <div>
          <b>${stationName}</b><br>
          <table style="font-size:12px;">
            <tr><td>æ–°æ©‹é§…ã¾ã§æœ€çŸ­æ‰€è¦æ™‚é–“</td><td>${travelTime}</td></tr>
            <tr><td>è‡ªç„¶ã®è±Šã‹ã•</td><td>${nature}</td></tr>
            <tr><td>é™ã‹ã•ï¼äººå£å¯†é›†åº¦</td><td>${quietness}</td></tr>
            <tr><td>1LDKè³ƒæ–™ç›¸å ´</td><td>${rent}</td></tr>
            <tr><td>è²¸è¾²åœ’ã®æœ‰ç„¡</td><td>${farm}</td></tr>
          </table>
          <div>
            <label>ãƒ¡ãƒ¢:</label>
            <textarea id="${id}" rows="2" cols="25" placeholder="ã“ã“ã«ãƒ¡ãƒ¢ã‚Œã‚‹ãœã„"></textarea><br>
            <button onclick="sendToSheet('${stationName}', '${id}')">ä¿å­˜ã™ã‚‹ã‹ã„ï¼Ÿ</button>
          </div>
        </div>`;
    }

    function sendToSheet(location, inputId) {
      const memo = document.getElementById(inputId).value;
      fetch("https://script.google.com/macros/s/AKfycbz4F9BbwF334O6ALoJRkYICRH2BnbrKDbHhYD4o0nsR-6AOhrUKT6Nes11mq6SCT3p9/exec", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ location, memo })
      })
      .then(res => res.json())
      .then(() => alert("ä¿å­˜ã•ã‚Œã¾ã—ãŸï¼"))
      .catch(err => alert("ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸï¼š" + err));
    }

    const stations = [
      {
        name: "ä¸­åæ¡é§…",
        lat: 35.7616,
        lng: 139.7253,
        time: "ç´„29åˆ†ï¼ˆåŸ¼äº¬ç·šâ†’äº¬æµœæ±åŒ—ç·šï¼‰",
        nature: "éƒ½å¸‚å…¬åœ’å°‘ãªã‚",
        quiet: "å¯†é›†ä½å®…åœ°ãƒ»é™ã‹ãªè£é“å¤šã„",
        rent: "ç´„9â€“11ä¸‡å††",
        farm: "ãªã—ï¼ˆéƒŠå¤–å‹ï¼‰"
      },
      {
        name: "åæ¡é§…",
        lat: 35.760255,
        lng: 139.7222794,
        time: "ç´„30åˆ†ï¼ˆåŸ¼äº¬ç·šâ†’äº¬æµœæ±åŒ—ç·šï¼‰",
        nature: "å°è¦æ¨¡å…¬åœ’ã®ã¿",
        quiet: "å•†åº—è¡—è³‘ã‚„ã‹ãƒ»ä½å®…å¯†é›†",
        rent: "ç´„10â€“12ä¸‡å††",
        farm: "ãªã—"
      },
      {
        name: "å¸‚å·é§…",
        lat: 35.7289,
        lng: 139.9254,
        time: "ç´„24åˆ†ã€œ27åˆ†ï¼ˆç·æ­¦å¿«é€Ÿç›´é€šï¼‰",
        nature: "æ±Ÿæˆ¸å·æ²¿ã„ç·‘åœ°å¤šæ•°",
        quiet: "ä¸­å¯†åº¦ãƒ»ä½å®…è¡—ä¸»ä½“",
        rent: "ç´„9.5â€“12ä¸‡å††",
        farm: "æœ‰ã‚Šï¼ˆå¸‚æ°‘è¾²åœ’å¤šæ•°ï¼‰"
      },
      {
        name: "äº¬æˆé«˜ç ‚é§…",
        lat: 35.7521,
        lng: 139.849,
        time: "ç´„27åˆ†ã€œ30åˆ†ï¼ˆç›´é€šã‚¢ã‚¯ã‚»ã‚¹ç‰¹æ€¥ï¼‰",
        nature: "æ±Ÿæˆ¸å·è¿‘ãã ãŒç·‘å°‘ãªã‚",
        quiet: "å¯†é›†ï¼†å•†æ¥­åœ°æ··åœ¨",
        rent: "ç´„8.5â€“11ä¸‡å††",
        farm: "ä¸€éƒ¨ã‚ã‚Šï¼ˆè‘›é£¾åŒºè¾²åœ’ï¼‰"
      },
      {
        name: "æ­¦è”µå°æ‰é§…",
        lat: 35.5701,
        lng: 139.6547,
        time: "ç´„14åˆ†ï¼ˆæ¨ªé ˆè³€ç·šç›´é€šï¼‰",
        nature: "å¤šæ‘©å·ãƒ»ç·‘åœ°ã‚ã‚‹",
        quiet: "è¶…é«˜å±¤ãƒãƒ³ã‚·ãƒ§ãƒ³å¯†é›†",
        rent: "ç´„14â€“17ä¸‡å††",
        farm: "ãªã—ï¼ˆå¸‚è¡—åœ°ï¼‰"
      },
      {
        name: "æ­¦è”µä¸­åŸé§…",
        lat: 35.5826,
        lng: 139.6387,
        time: "ç´„25ã€œ28åˆ†ï¼ˆå—æ­¦ç·šâ†’æ¨ªé ˆè³€ç·šï¼‰",
        nature: "ç·‘åœ°ã¯å°è¦æ¨¡",
        quiet: "ãƒãƒ³ã‚·ãƒ§ãƒ³ä¸­å¿ƒãƒ»ã‚„ã‚„å¯†é›†",
        rent: "ç´„12â€“15ä¸‡å††",
        farm: "ãªã—"
      },
      {
        name: "æ¾æˆ¸é§…",
        lat: 35.7897,
        lng: 139.9036,
        time: "ç´„27åˆ†ï¼ˆå¸¸ç£ç·šç›´é€šï¼‰",
        nature: "æ±Ÿæˆ¸å·ãƒ»21ä¸–ç´€ã®æ£®ãªã©",
        quiet: "åºƒã‚ã®ä½å®…è¡—ãƒ»ä¸­å¯†åº¦",
        rent: "ç´„7â€“11ä¸‡å††",
        farm: "æœ‰ã‚Šï¼ˆå¸‚æ°‘è¾²åœ’ï¼‰"
      },
      {
        name: "æ´¥ç”°æ²¼é§…",
        lat: 35.6945,
        lng: 140.0298,
        time: "ç´„32ã€œ34åˆ†ï¼ˆç·æ­¦å¿«é€Ÿâ†’æ¨ªé ˆè³€ç·šï¼‰",
        nature: "è°·æ´¥å¹²æ½Ÿãƒ»ç·‘åœ°å¤šã„",
        quiet: "å•†æ¥­ãƒ»ä½å®…ãƒãƒ©ãƒ³ã‚¹è‰¯å¥½",
        rent: "ç´„7â€“10ä¸‡å††",
        farm: "æœ‰ã‚Šï¼ˆå¸‚æ°‘è¾²åœ’å¤šã‚ï¼‰"
      },
      {
        name: "ä¹…ãŒåŸé§…",
        lat: 35.6029,
        lng: 139.7003,
        time: "ç´„34åˆ†_æ–°æ©‹",
        nature: "ï¼ˆæœªè¨˜å…¥ï¼‰",
        quiet: "ï¼ˆæœªè¨˜å…¥ï¼‰",
        rent: "ï¼ˆæœªè¨˜å…¥ï¼‰",
        farm: "ï¼ˆæœªè¨˜å…¥ï¼‰"
      },
      {
        name: "ç­‰ã€…åŠ›é§…",
        lat: 35.608373,
        lng: 139.647841,
        time: "ç´„31åˆ†_è™ãƒé–€ãƒ’ãƒ«ã‚º",
        nature: "ç­‰ã€…åŠ›æ¸“è°·",
        quiet: "ï¼ˆæœªè¨˜å…¥ï¼‰",
        rent: "é«˜ã„",
        farm: "ãªã„ã­"
      },
      {
        name: "æœ¬å…«å¹¡é§…",
        lat: 35.7221,
        lng: 139.929,
        time: "ç´„27åˆ†_æ–°æ©‹",
        nature: "ï¼ˆæœªè¨˜å…¥ï¼‰",
        quiet: "ï¼ˆæœªè¨˜å…¥ï¼‰",
        rent: "8ä¸‡ï½ï¼Ÿ",
        farm: "ã‚ã‚‹ã‹ã‚‚"
      }
    ];

    stations.forEach(s => {
      const icon = L.AwesomeMarkers.icon({
        icon: 'smile',
        prefix: 'fa',
        markerColor: 'blue',
        iconColor: 'black',
        extraClasses: 'smile-hover'
      });
      const marker = L.marker([s.lat, s.lng], { icon }).addTo(map);
      marker.bindPopup(createPopupContent(s.name, s.time, s.nature, s.quiet, s.rent, s.farm));
    
    const label = L.divIcon({
        className: 'station-label',
        html: s.name,
        iconSize: null
      });
      L.marker([s.lat + 0.001, s.lng], { icon: label, interactive: false }).addTo(map);
    });
  </script>
</body>
</html>
